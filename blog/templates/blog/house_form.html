{% extends 'blog/base.html' %}
{% load static %}

{% block title %}{% if form.instance.pk %}Edit Your Listing{% else %}List Your Property{% endif %} - HouseFinder{% endblock %}

{% block content %}
<div class="form-container">
  <div class="form-header">
    <h1>{% if form.instance.pk %}Edit Your Property{% else %}List Your Property{% endif %}</h1>
    <p>Fill out the details below to {% if form.instance.pk %}update{% else %}create{% endif %} your listing.</p>
  </div>

  <form method="POST" enctype="multipart/form-data" novalidate>
    {% csrf_token %}
    {# Show non-field errors if there are any #}
    {% if form.non_field_errors %}
      <div class="message error">
        {{ form.non_field_errors }}
      </div>
    {% endif %}

    <fieldset>
      <legend>Property Details</legend>
      <div class="form-group full-width">
        <label for="{{ form.title.id_for_label }}">Title</label>
        {{ form.title }}
        {% if form.title.errors %}
          <ul class="errorlist">
            {% for error in form.title.errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
      <div class="form-group full-width">
        <label for="{{ form.description.id_for_label }}">Description</label>
        {{ form.description }}
        {% if form.description.errors %}
          <ul class="errorlist">
            {% for error in form.description.errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        {% endif %}
      </div>
      <div class="form-grid">
        <div class="form-group">
          <label for="{{ form.operationType.id_for_label }}">Listing Type</label>
          {{ form.operationType }}
          {% if form.operationType.errors %}
            <ul class="errorlist">
              {% for error in form.operationType.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.price.id_for_label }}">Price (DZD)</label>
          {{ form.price }}
          {% if form.price.errors %}
            <ul class="errorlist">
              {% for error in form.price.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Specifications</legend>
      <div class="form-grid">
        <div class="form-group">
          <label for="{{ form.length.id_for_label }}">Length (m)</label>
          {{ form.length }}
          {% if form.length.errors %}
            <ul class="errorlist">
              {% for error in form.length.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.width.id_for_label }}">Width (m)</label>
          {{ form.width }}
          {% if form.width.errors %}
            <ul class="errorlist">
              {% for error in form.width.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.faces.id_for_label }}">Faces</label>
          {{ form.faces }}
          {% if form.faces.errors %}
            <ul class="errorlist">
              {% for error in form.faces.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Location</legend>
      <div class="form-grid">
        <div class="form-group">
          <label for="{{ form.state.id_for_label }}">State</label>
          {{ form.state }}
          {% if form.state.errors %}
            <ul class="errorlist">
              {% for error in form.state.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.district.id_for_label }}">District</label>
          {{ form.district }}
          {% if form.district.errors %}
            <ul class="errorlist">
              {% for error in form.district.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group full-width">
          <label for="{{ form.municipality.id_for_label }}">Municipality</label>
          {{ form.municipality }}
          {% if form.municipality.errors %}
            <ul class="errorlist">
              {% for error in form.municipality.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.latitude.id_for_label }}">Latitude</label>
          {{ form.latitude }}
          {% if form.latitude.errors %}
            <ul class="errorlist">
              {% for error in form.latitude.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.longitude.id_for_label }}">Longitude</label>
          {{ form.longitude }}
          {% if form.longitude.errors %}
            <ul class="errorlist">
              {% for error in form.longitude.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Availability</legend>
      <div class="form-grid">
        <div class="form-group">
          <label for="{{ form.status.id_for_label }}">Status</label>
          {{ form.status }}
          {% if form.status.errors %}
            <ul class="errorlist">
              {% for error in form.status.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
        <div class="form-group">
          <label for="{{ form.available_from.id_for_label }}">Available From</label>
          {{ form.available_from }}
          {% if form.available_from.help_text %}
            <div class="helptext">{{ form.available_from.help_text }}</div>
          {% endif %}
          {% if form.available_from.errors %}
            <ul class="errorlist">
              {% for error in form.available_from.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>
      </div>
    </fieldset>

    <fieldset>
      <legend>Images</legend>
      <div class="form-group full-width">
        <label for="id_images">Upload Images</label>
        <input type="file" name="images" id="id_images" multiple accept="image/*">
        <div class="helptext">You can select multiple images to upload.</div>
      </div>
    </fieldset>

    <button type="submit" class="btn-submit">
      {% if form.instance.pk %}Update Listing{% else %}Create Listing{% endif %}
    </button>
  </form>
</div>
{% endblock %}